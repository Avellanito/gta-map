<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mapa GTA GPS</title>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: Arial, sans-serif;
    }

    #map {
      height: 100vh;
      width: 100vw;
    }

    .bar {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      background: rgba(255,255,255,0.95);
      padding: 10px;
      border-radius: 12px;
      display: flex;
      gap: 8px;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .bar input {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    .bar button {
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      background: black;
      color: white;
      cursor: pointer;
    }

    .bar button:hover {
      opacity: 0.8;
    }
  </style>
</head>

<body>

<div class="bar">
  <input id="destino" type="text" placeholder="Escribe tu destino (ej: Plaza España, Madrid)">
  <button onclick="calcularRuta()">Ir</button>
</div>

<div id="map"></div>

<script>
let map;
let directionsService;
let directionsRenderer;

function initMap() {
  map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: 40.4168, lng: -3.7038 },
    zoom: 13,
    mapId: "818f2355ad2d42eff8904298",
    fullscreenControl: false,
    mapTypeControl: false,
    streetViewControl: false
  });

  directionsService = new google.maps.DirectionsService();

  directionsRenderer = new google.maps.DirectionsRenderer({
    map: map,
    polylineOptions: {
      strokeColor: "#ffffff",   // Línea blanca estilo GTA
      strokeWeight: 5
    }
  });

  // Centrar mapa en tu ubicación al abrir
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (position) => {
        const userLocation = {
          lat: position.coords.latitude,
          lng: position.coords.longitude
        };
        map.setCenter(userLocation);
        map.setZoom(14);
      }
    );
  }
}

function calcularRuta() {
  const destino = document.getElementById("destino").value.trim();
  if (!destino) {
    alert("Escribe un destino primero.");
    return;
  }

  if (!navigator.geolocation) {
    alert("Tu navegador no permite geolocalización.");
    return;
  }

  navigator.geolocation.getCurrentPosition(
    (position) => {
      const origen = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };

      directionsService.route({
        origin: origen,
        destination: destino,
        travelMode: google.maps.TravelMode.DRIVING
      }).then((response) => {
        directionsRenderer.setDirections(response);
      }).catch((error) => {
        alert("No se pudo calcular la ruta.");
        console.error(error);
      });
    },
    () => {
      alert("Activa la ubicación para usar el GPS.");
    }
  );
}

window.initMap = initMap;
</script>

<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDpS3k1OJAASoGL1IRb9LjKW6gjaHe5fyw&callback=initMap&v=weekly"
  defer>
</script>

</body>
</html>


